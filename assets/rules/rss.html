<!DOCTYPE html>

<head>
    <title>RSS 解析器，并以 Markdown 形式返回</title>
    <script src="https://cdn.jsdelivr.net/npm/rss-parser@3.13.0/dist/rss-parser.min.js"></script>
</head>

<body>
<button id="fetchButton">Fetch Data</button>

<script>
    document.getElementById('fetchButton').addEventListener('click', getReaderData);

    function getReaderData(url) {
        let parser = new RSSParser();
        parser.parseURL(url, function (err, feed) {
            if (err) {
                window.flutter_inappwebview.callHandler('reader-fail');
                throw err;
            }
            console.log('Title:', feed.title);
            // 拼装数据
            var result = [];
            feed.items.forEach(function (entry) {
                result.push({
                    url: entry.link,
                    title: entry.title,
                });
            })
            console.log('Result:', result);
            window.flutter_inappwebview.callHandler('reader-success', result);
        })
    }
</script>
</body>